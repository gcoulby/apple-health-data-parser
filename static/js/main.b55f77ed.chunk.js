(this["webpackJsonpapple-health-parser"]=this["webpackJsonpapple-health-parser"]||[]).push([[0],{35:function(e,t,a){},36:function(e,t,a){},43:function(e,t,a){},48:function(e,t){},50:function(e,t){},60:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(25),s=a.n(c),i=(a(35),a(36),a(26)),o=a(27),l=a(30),d=a(29),h=(a(37),a(38),a(39),a(28)),j=a.n(h),u=(a(43),a.p+"static/media/erdf.dd68eb2a.svg"),p=a.p+"static/media/northumbria.9f973ad5.svg",m=a.p+"static/media/ryder.0a9e1d7e.svg",b=a(0),f=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={recordFields:["sourceName","sourceVersion","device","type","unit","creationDate","startDate","endDate","value"],status:Object(b.jsxs)("span",{children:[Object(b.jsx)("strong",{children:"No File Loaded."})," Drag a file into the box below to begin"]}),alertLevel:"secondary",fileContents:"",records:[],categories:[]},e.handleOnDragOver=function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},e.handleOnDrop=function(t){t.stopPropagation(),t.preventDefault();var a=t.dataTransfer.files;e.readBlob(a[0]),e.setState({status:Object(b.jsxs)("span",{children:["Parsing data from ",Object(b.jsx)("strong",{children:a[0].name}),"."]})}),e.setState({alertLevel:"info"})},e.handleOnCheck=function(t,a){var r=e.state.categories.map((function(e){return e.name===a&&(e.checked=t.target.checked),e}));e.setState({categories:r})},e.handleDownloadClick=function(){e.createZipFile()},e.saveData=function(e,t){var a=document.createElement("a");document.body.appendChild(a),a.setAttribute("style","display:none");var r=window.URL.createObjectURL(e);a.href=r,a.download=t,a.click(),window.URL.revokeObjectURL(r)},e.createZipFile=function(){var t=e.state.categories.filter((function(e){return e.checked}));if(0===t.length)return e.setState({status:"No categories selected. Please select a cateogory before clicking download"}),void e.setState({alertLevel:"danger"});var a=new j.a,r=new Date,n=r.toDateString(),c=r.toLocaleTimeString().replace(/:/gm,"_");t.map((function(t){return a.file("".concat(t.name,"_").concat(n,"-").concat(c,".csv"),e.arrayToCsv(e.state.records[t.name])),t})),a.generateAsync({type:"blob"}).then((function(t){e.saveData(t,"health_data_".concat(n,"-").concat(c,".zip"))}))},e.readBlob=function(t){var r=t.size-1,n=new FileReader;n.onloadend=function(t){if(t.target.readyState===FileReader.DONE){e.setState({fileContents:t.target.result});var r=a(45).xml2json(t.target.result,{compact:!0,spaces:4}),n=e.state.records,c=e.state.categories;JSON.parse(r).HealthData.Record.map((function(t){var a=t._attributes.type.replace(/HK.*TypeIdentifier/i,"");return a in e.state.records||(n[a]=[],c.push({name:a,checked:!1})),n[a].push(t._attributes),t})),e.setState({records:n}),e.setState({categories:c}),e.setState({healthData:JSON.parse(r).HealthData.Record}),e.setState({status:Object(b.jsx)("strong",{children:"Parsing data complete."})}),e.setState({alertLevel:"success"})}};var c=t.slice(0,r+1);n.readAsBinaryString(c)},e}return Object(o.a)(r,[{key:"arrayToCsv",value:function(e){var t=this,a=this.state.recordFields.join(",")+"\r\n";return a+=e.map((function(e){return t.state.recordFields.map((function(t){return e[t]})).join(",")+"\r\n"})).join("\n")}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("header",{children:Object(b.jsx)("div",{className:"jumbotron",children:Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"row mt-5",children:Object(b.jsxs)("div",{className:"col",children:[Object(b.jsx)("h1",{className:"display-4",children:"iOS Health Data Parser"}),Object(b.jsx)("p",{className:"lead",children:"This is application parses the XML data exported from iOS Health app and creates CSV files for the chosen health categories."}),Object(b.jsx)("hr",{className:"my-4"}),Object(b.jsx)("p",{children:"This application was developed to support research funded by Northumbria University and the European Regional Development Fund\u2019s Intensive Industrial Innovation Programme as part of doctoral PhD programme. The sponsoring Small to Medium Enterprise for this programme was Ryder Architecture and it was delivered through Northumbria University."}),Object(b.jsx)("div",{className:"container",children:Object(b.jsxs)("div",{className:"row my-4",children:[Object(b.jsx)("div",{className:"col-4",children:Object(b.jsx)("a",{target:"_blank",href:"https://ec.europa.eu/regional_policy/en/funding/erdf/",rel:"noreferrer noopener",children:Object(b.jsx)("img",{src:u,alt:"European Regional Development Fund logo"})})}),Object(b.jsx)("div",{className:"col-4",children:Object(b.jsx)("a",{target:"_blank",href:"https://www.northumbria.ac.uk/",rel:"noreferrer noopener",children:Object(b.jsx)("img",{src:p,alt:"Northumbria University Logo"})})}),Object(b.jsx)("div",{className:"col-4",children:Object(b.jsx)("a",{target:"_blank",href:"https://ryderarchitecture.com",rel:"noreferrer noopener",children:Object(b.jsx)("img",{src:m,alt:"Ryder Architecture Logo"})})})]})}),Object(b.jsx)("hr",{className:"my-4"}),Object(b.jsx)("h5",{children:"Data Privacy Statement"}),Object(b.jsx)("p",{children:"This app works client-side (processed by your browser) and no data is collected, stored or managed by this application. When the Save File(s) button is clicked a file is generated locally in your browser and will automatically download to your machine as a compressed archive."})]})})})})}),Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"col",children:[Object(b.jsx)("p",{className:"alert alert-".concat(this.state.alertLevel),id:"file_name",children:this.state.status}),Object(b.jsx)("div",{id:"drop_zone",onDragOver:function(t){return e.handleOnDragOver(t)},onDrop:function(t){return e.handleOnDrop(t)},children:Object(b.jsx)("p",{children:"DROP iOS Health export.xml FILE\xa0HERE"})})]})}),Object(b.jsx)("div",{className:"row mt-4",children:Object(b.jsx)("div",{className:"col",children:Object(b.jsx)("div",{className:"alert alert-warning",role:"alert",children:"After the file has been parsed, a list of health categories will be generated below. From this list, select the categories you wish export then press the export button"})})}),Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-8",children:Object(b.jsx)("ul",{id:"category",children:this.state.categories.map((function(t){return Object(b.jsx)(n.a.Fragment,{children:Object(b.jsx)("li",{children:Object(b.jsxs)("div",{className:"form-check form-switch",children:[Object(b.jsx)("input",{className:"form-check-input",type:"checkbox",id:"".concat(t.name,"_flexSwitchCheckDefault"),checked:t.checked,onChange:function(a){return e.handleOnCheck(a,t.name)}},"".concat(t.name,"_input")),Object(b.jsx)("label",{className:"form-check-label",htmlFor:"".concat(t.name,"_flexSwitchCheckDefault"),children:t.name},"".concat(t.name,"_label+"))]},"".concat(t.name,"_switch"))},t.name)},"".concat(t.name,"_fragment"))}))})}),Object(b.jsx)("div",{className:"col-4",children:this.state.categories.length>0?Object(b.jsx)("div",{className:"d-grid gap-2",children:Object(b.jsxs)("button",{className:"btn btn-primary btn-lg",type:"button",onClick:function(){return e.handleDownloadClick()},children:[Object(b.jsx)("i",{className:"fa fa-download"}),"\xa0Save File(s)"]})},"download_btn"):n.a.Fragment})]})]})]})}}]),r}(r.Component),g=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,61)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),r(e),n(e),c(e),s(e)}))};s.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(f,{})}),document.getElementById("root")),g()}},[[60,1,2]]]);
//# sourceMappingURL=main.b55f77ed.chunk.js.map